1. Использование SQL_EscapeString или hg_db.Escape вместо HxProtect(sName) только уменьшит общую защиту от взлома.
2. Глобальные переменные sg_query1, sg_query2, sg_query3, sg_query4, sg_buf1, sg_buf2, sg_buf3 предназначены для уменьшения нагрузки плагина на сервер. Уменьшение незначительно, но даётся бесплатно.
3. SQL-запросы в OnClientDisconnect и Event_SQL_Save легко объединяются в одну функцию. Код занимает такой же объём, но функция превращается в сложного монстра со множеством защит. Разделение сделано для максимально удобного восприятия кода. На скорость работы плагина это не влияет.
4. Перед сменой карты принудительно закрывается соединение с базой данных. Так сделано специально, чтобы при каких-либо проблемах с подключением к базе данных проблема решилась самостоятельно на новой карте.
5. Использование #define вместо магических чисел только усложнит чтение кода.
6. Основная цень, сделать сложную логику плагина максимально одобной для чтения и восприятия.
